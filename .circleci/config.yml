version: 2
jobs:
    build:
        working_directory: ~/PersonalWebsite
        docker:
            - image: circleci/node:7.10
        steps:
            - checkout
            - run: 
                   npm install -g hexo-cli
                   
                   npm install
            
                   yarn add hexo-renderer-jade
                   
                   yarn add hexo-prism-plugin
                   
                   hexo generate
            - deploy:
                    name: Production Deploy
                    command: |
                      if [ "${CIRCLE_BRANCH}" == "master" ]; then
                          hexo generate
                          scp -r -o StrictHostKeyChecking=no /public $PROD_USER@$PROD_IP:/PersonalWebsite
                      fi
